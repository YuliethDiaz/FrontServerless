{"ast":null,"code":"'use strict';\n\nlet {\n  SourceMapConsumer,\n  SourceMapGenerator\n} = require('source-map-js');\n\nlet {\n  dirname,\n  resolve,\n  relative,\n  sep\n} = require('path');\n\nlet {\n  pathToFileURL\n} = require('url');\n\nlet Input = require('./input');\n\nlet sourceMapAvailable = Boolean(SourceMapConsumer && SourceMapGenerator);\nlet pathAvailable = Boolean(dirname && resolve && relative && sep);\n\nclass MapGenerator {\n  constructor(stringify, root, opts, cssString) {\n    this.stringify = stringify;\n    this.mapOpts = opts.map || {};\n    this.root = root;\n    this.opts = opts;\n    this.css = cssString;\n  }\n\n  isMap() {\n    if (typeof this.opts.map !== 'undefined') {\n      return !!this.opts.map;\n    }\n\n    return this.previous().length > 0;\n  }\n\n  previous() {\n    if (!this.previousMaps) {\n      this.previousMaps = [];\n\n      if (this.root) {\n        this.root.walk(node => {\n          if (node.source && node.source.input.map) {\n            let map = node.source.input.map;\n\n            if (!this.previousMaps.includes(map)) {\n              this.previousMaps.push(map);\n            }\n          }\n        });\n      } else {\n        let input = new Input(this.css, this.opts);\n        if (input.map) this.previousMaps.push(input.map);\n      }\n    }\n\n    return this.previousMaps;\n  }\n\n  isInline() {\n    if (typeof this.mapOpts.inline !== 'undefined') {\n      return this.mapOpts.inline;\n    }\n\n    let annotation = this.mapOpts.annotation;\n\n    if (typeof annotation !== 'undefined' && annotation !== true) {\n      return false;\n    }\n\n    if (this.previous().length) {\n      return this.previous().some(i => i.inline);\n    }\n\n    return true;\n  }\n\n  isSourcesContent() {\n    if (typeof this.mapOpts.sourcesContent !== 'undefined') {\n      return this.mapOpts.sourcesContent;\n    }\n\n    if (this.previous().length) {\n      return this.previous().some(i => i.withContent());\n    }\n\n    return true;\n  }\n\n  clearAnnotation() {\n    if (this.mapOpts.annotation === false) return;\n\n    if (this.root) {\n      let node;\n\n      for (let i = this.root.nodes.length - 1; i >= 0; i--) {\n        node = this.root.nodes[i];\n        if (node.type !== 'comment') continue;\n\n        if (node.text.indexOf('# sourceMappingURL=') === 0) {\n          this.root.removeChild(i);\n        }\n      }\n    } else if (this.css) {\n      this.css = this.css.replace(/(\\n)?\\/\\*#[\\S\\s]*?\\*\\/$/gm, '');\n    }\n  }\n\n  setSourcesContent() {\n    let already = {};\n\n    if (this.root) {\n      this.root.walk(node => {\n        if (node.source) {\n          let from = node.source.input.from;\n\n          if (from && !already[from]) {\n            already[from] = true;\n            this.map.setSourceContent(this.toUrl(this.path(from)), node.source.input.css);\n          }\n        }\n      });\n    } else if (this.css) {\n      let from = this.opts.from ? this.toUrl(this.path(this.opts.from)) : '<no source>';\n      this.map.setSourceContent(from, this.css);\n    }\n  }\n\n  applyPrevMaps() {\n    for (let prev of this.previous()) {\n      let from = this.toUrl(this.path(prev.file));\n      let root = prev.root || dirname(prev.file);\n      let map;\n\n      if (this.mapOpts.sourcesContent === false) {\n        map = new SourceMapConsumer(prev.text);\n\n        if (map.sourcesContent) {\n          map.sourcesContent = map.sourcesContent.map(() => null);\n        }\n      } else {\n        map = prev.consumer();\n      }\n\n      this.map.applySourceMap(map, from, this.toUrl(this.path(root)));\n    }\n  }\n\n  isAnnotation() {\n    if (this.isInline()) {\n      return true;\n    }\n\n    if (typeof this.mapOpts.annotation !== 'undefined') {\n      return this.mapOpts.annotation;\n    }\n\n    if (this.previous().length) {\n      return this.previous().some(i => i.annotation);\n    }\n\n    return true;\n  }\n\n  toBase64(str) {\n    if (Buffer) {\n      return Buffer.from(str).toString('base64');\n    } else {\n      return window.btoa(unescape(encodeURIComponent(str)));\n    }\n  }\n\n  addAnnotation() {\n    let content;\n\n    if (this.isInline()) {\n      content = 'data:application/json;base64,' + this.toBase64(this.map.toString());\n    } else if (typeof this.mapOpts.annotation === 'string') {\n      content = this.mapOpts.annotation;\n    } else if (typeof this.mapOpts.annotation === 'function') {\n      content = this.mapOpts.annotation(this.opts.to, this.root);\n    } else {\n      content = this.outputFile() + '.map';\n    }\n\n    let eol = '\\n';\n    if (this.css.includes('\\r\\n')) eol = '\\r\\n';\n    this.css += eol + '/*# sourceMappingURL=' + content + ' */';\n  }\n\n  outputFile() {\n    if (this.opts.to) {\n      return this.path(this.opts.to);\n    } else if (this.opts.from) {\n      return this.path(this.opts.from);\n    } else {\n      return 'to.css';\n    }\n  }\n\n  generateMap() {\n    if (this.root) {\n      this.generateString();\n    } else if (this.previous().length === 1) {\n      let prev = this.previous()[0].consumer();\n      prev.file = this.outputFile();\n      this.map = SourceMapGenerator.fromSourceMap(prev);\n    } else {\n      this.map = new SourceMapGenerator({\n        file: this.outputFile()\n      });\n      this.map.addMapping({\n        source: this.opts.from ? this.toUrl(this.path(this.opts.from)) : '<no source>',\n        generated: {\n          line: 1,\n          column: 0\n        },\n        original: {\n          line: 1,\n          column: 0\n        }\n      });\n    }\n\n    if (this.isSourcesContent()) this.setSourcesContent();\n    if (this.root && this.previous().length > 0) this.applyPrevMaps();\n    if (this.isAnnotation()) this.addAnnotation();\n\n    if (this.isInline()) {\n      return [this.css];\n    } else {\n      return [this.css, this.map];\n    }\n  }\n\n  path(file) {\n    if (file.indexOf('<') === 0) return file;\n    if (/^\\w+:\\/\\//.test(file)) return file;\n    if (this.mapOpts.absolute) return file;\n    let from = this.opts.to ? dirname(this.opts.to) : '.';\n\n    if (typeof this.mapOpts.annotation === 'string') {\n      from = dirname(resolve(from, this.mapOpts.annotation));\n    }\n\n    file = relative(from, file);\n    return file;\n  }\n\n  toUrl(path) {\n    if (sep === '\\\\') {\n      path = path.replace(/\\\\/g, '/');\n    }\n\n    return encodeURI(path).replace(/[#?]/g, encodeURIComponent);\n  }\n\n  sourcePath(node) {\n    if (this.mapOpts.from) {\n      return this.toUrl(this.mapOpts.from);\n    } else if (this.mapOpts.absolute) {\n      if (pathToFileURL) {\n        return pathToFileURL(node.source.input.from).toString();\n      } else {\n        throw new Error('`map.absolute` option is not available in this PostCSS build');\n      }\n    } else {\n      return this.toUrl(this.path(node.source.input.from));\n    }\n  }\n\n  generateString() {\n    this.css = '';\n    this.map = new SourceMapGenerator({\n      file: this.outputFile()\n    });\n    let line = 1;\n    let column = 1;\n    let noSource = '<no source>';\n    let mapping = {\n      source: '',\n      generated: {\n        line: 0,\n        column: 0\n      },\n      original: {\n        line: 0,\n        column: 0\n      }\n    };\n    let lines, last;\n    this.stringify(this.root, (str, node, type) => {\n      this.css += str;\n\n      if (node && type !== 'end') {\n        mapping.generated.line = line;\n        mapping.generated.column = column - 1;\n\n        if (node.source && node.source.start) {\n          mapping.source = this.sourcePath(node);\n          mapping.original.line = node.source.start.line;\n          mapping.original.column = node.source.start.column - 1;\n          this.map.addMapping(mapping);\n        } else {\n          mapping.source = noSource;\n          mapping.original.line = 1;\n          mapping.original.column = 0;\n          this.map.addMapping(mapping);\n        }\n      }\n\n      lines = str.match(/\\n/g);\n\n      if (lines) {\n        line += lines.length;\n        last = str.lastIndexOf('\\n');\n        column = str.length - last;\n      } else {\n        column += str.length;\n      }\n\n      if (node && type !== 'start') {\n        let p = node.parent || {\n          raws: {}\n        };\n\n        if (node.type !== 'decl' || node !== p.last || p.raws.semicolon) {\n          if (node.source && node.source.end) {\n            mapping.source = this.sourcePath(node);\n            mapping.original.line = node.source.end.line;\n            mapping.original.column = node.source.end.column - 1;\n            mapping.generated.line = line;\n            mapping.generated.column = column - 2;\n            this.map.addMapping(mapping);\n          } else {\n            mapping.source = noSource;\n            mapping.original.line = 1;\n            mapping.original.column = 0;\n            mapping.generated.line = line;\n            mapping.generated.column = column - 1;\n            this.map.addMapping(mapping);\n          }\n        }\n      }\n    });\n  }\n\n  generate() {\n    this.clearAnnotation();\n\n    if (pathAvailable && sourceMapAvailable && this.isMap()) {\n      return this.generateMap();\n    } else {\n      let result = '';\n      this.stringify(this.root, i => {\n        result += i;\n      });\n      return [result];\n    }\n  }\n\n}\n\nmodule.exports = MapGenerator;","map":{"version":3,"sources":["C:/Users/Valen/OneDrive/Documentos/Proyecto AWS/FrontServerless/node_modules/postcss/lib/map-generator.js"],"names":["SourceMapConsumer","SourceMapGenerator","require","dirname","resolve","relative","sep","pathToFileURL","Input","sourceMapAvailable","Boolean","pathAvailable","MapGenerator","constructor","stringify","root","opts","cssString","mapOpts","map","css","isMap","previous","length","previousMaps","walk","node","source","input","includes","push","isInline","inline","annotation","some","i","isSourcesContent","sourcesContent","withContent","clearAnnotation","nodes","type","text","indexOf","removeChild","replace","setSourcesContent","already","from","setSourceContent","toUrl","path","applyPrevMaps","prev","file","consumer","applySourceMap","isAnnotation","toBase64","str","Buffer","toString","window","btoa","unescape","encodeURIComponent","addAnnotation","content","to","outputFile","eol","generateMap","generateString","fromSourceMap","addMapping","generated","line","column","original","test","absolute","encodeURI","sourcePath","Error","noSource","mapping","lines","last","start","match","lastIndexOf","p","parent","raws","semicolon","end","generate","result","module","exports"],"mappings":"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","sourcesContent":["'use strict'\r\n\r\nlet { SourceMapConsumer, SourceMapGenerator } = require('source-map-js')\r\nlet { dirname, resolve, relative, sep } = require('path')\r\nlet { pathToFileURL } = require('url')\r\n\r\nlet Input = require('./input')\r\n\r\nlet sourceMapAvailable = Boolean(SourceMapConsumer && SourceMapGenerator)\r\nlet pathAvailable = Boolean(dirname && resolve && relative && sep)\r\n\r\nclass MapGenerator {\r\n  constructor(stringify, root, opts, cssString) {\r\n    this.stringify = stringify\r\n    this.mapOpts = opts.map || {}\r\n    this.root = root\r\n    this.opts = opts\r\n    this.css = cssString\r\n  }\r\n\r\n  isMap() {\r\n    if (typeof this.opts.map !== 'undefined') {\r\n      return !!this.opts.map\r\n    }\r\n    return this.previous().length > 0\r\n  }\r\n\r\n  previous() {\r\n    if (!this.previousMaps) {\r\n      this.previousMaps = []\r\n      if (this.root) {\r\n        this.root.walk(node => {\r\n          if (node.source && node.source.input.map) {\r\n            let map = node.source.input.map\r\n            if (!this.previousMaps.includes(map)) {\r\n              this.previousMaps.push(map)\r\n            }\r\n          }\r\n        })\r\n      } else {\r\n        let input = new Input(this.css, this.opts)\r\n        if (input.map) this.previousMaps.push(input.map)\r\n      }\r\n    }\r\n\r\n    return this.previousMaps\r\n  }\r\n\r\n  isInline() {\r\n    if (typeof this.mapOpts.inline !== 'undefined') {\r\n      return this.mapOpts.inline\r\n    }\r\n\r\n    let annotation = this.mapOpts.annotation\r\n    if (typeof annotation !== 'undefined' && annotation !== true) {\r\n      return false\r\n    }\r\n\r\n    if (this.previous().length) {\r\n      return this.previous().some(i => i.inline)\r\n    }\r\n    return true\r\n  }\r\n\r\n  isSourcesContent() {\r\n    if (typeof this.mapOpts.sourcesContent !== 'undefined') {\r\n      return this.mapOpts.sourcesContent\r\n    }\r\n    if (this.previous().length) {\r\n      return this.previous().some(i => i.withContent())\r\n    }\r\n    return true\r\n  }\r\n\r\n  clearAnnotation() {\r\n    if (this.mapOpts.annotation === false) return\r\n\r\n    if (this.root) {\r\n      let node\r\n      for (let i = this.root.nodes.length - 1; i >= 0; i--) {\r\n        node = this.root.nodes[i]\r\n        if (node.type !== 'comment') continue\r\n        if (node.text.indexOf('# sourceMappingURL=') === 0) {\r\n          this.root.removeChild(i)\r\n        }\r\n      }\r\n    } else if (this.css) {\r\n      this.css = this.css.replace(/(\\n)?\\/\\*#[\\S\\s]*?\\*\\/$/gm, '')\r\n    }\r\n  }\r\n\r\n  setSourcesContent() {\r\n    let already = {}\r\n    if (this.root) {\r\n      this.root.walk(node => {\r\n        if (node.source) {\r\n          let from = node.source.input.from\r\n          if (from && !already[from]) {\r\n            already[from] = true\r\n            this.map.setSourceContent(\r\n              this.toUrl(this.path(from)),\r\n              node.source.input.css\r\n            )\r\n          }\r\n        }\r\n      })\r\n    } else if (this.css) {\r\n      let from = this.opts.from\r\n        ? this.toUrl(this.path(this.opts.from))\r\n        : '<no source>'\r\n      this.map.setSourceContent(from, this.css)\r\n    }\r\n  }\r\n\r\n  applyPrevMaps() {\r\n    for (let prev of this.previous()) {\r\n      let from = this.toUrl(this.path(prev.file))\r\n      let root = prev.root || dirname(prev.file)\r\n      let map\r\n\r\n      if (this.mapOpts.sourcesContent === false) {\r\n        map = new SourceMapConsumer(prev.text)\r\n        if (map.sourcesContent) {\r\n          map.sourcesContent = map.sourcesContent.map(() => null)\r\n        }\r\n      } else {\r\n        map = prev.consumer()\r\n      }\r\n\r\n      this.map.applySourceMap(map, from, this.toUrl(this.path(root)))\r\n    }\r\n  }\r\n\r\n  isAnnotation() {\r\n    if (this.isInline()) {\r\n      return true\r\n    }\r\n    if (typeof this.mapOpts.annotation !== 'undefined') {\r\n      return this.mapOpts.annotation\r\n    }\r\n    if (this.previous().length) {\r\n      return this.previous().some(i => i.annotation)\r\n    }\r\n    return true\r\n  }\r\n\r\n  toBase64(str) {\r\n    if (Buffer) {\r\n      return Buffer.from(str).toString('base64')\r\n    } else {\r\n      return window.btoa(unescape(encodeURIComponent(str)))\r\n    }\r\n  }\r\n\r\n  addAnnotation() {\r\n    let content\r\n\r\n    if (this.isInline()) {\r\n      content =\r\n        'data:application/json;base64,' + this.toBase64(this.map.toString())\r\n    } else if (typeof this.mapOpts.annotation === 'string') {\r\n      content = this.mapOpts.annotation\r\n    } else if (typeof this.mapOpts.annotation === 'function') {\r\n      content = this.mapOpts.annotation(this.opts.to, this.root)\r\n    } else {\r\n      content = this.outputFile() + '.map'\r\n    }\r\n    let eol = '\\n'\r\n    if (this.css.includes('\\r\\n')) eol = '\\r\\n'\r\n\r\n    this.css += eol + '/*# sourceMappingURL=' + content + ' */'\r\n  }\r\n\r\n  outputFile() {\r\n    if (this.opts.to) {\r\n      return this.path(this.opts.to)\r\n    } else if (this.opts.from) {\r\n      return this.path(this.opts.from)\r\n    } else {\r\n      return 'to.css'\r\n    }\r\n  }\r\n\r\n  generateMap() {\r\n    if (this.root) {\r\n      this.generateString()\r\n    } else if (this.previous().length === 1) {\r\n      let prev = this.previous()[0].consumer()\r\n      prev.file = this.outputFile()\r\n      this.map = SourceMapGenerator.fromSourceMap(prev)\r\n    } else {\r\n      this.map = new SourceMapGenerator({ file: this.outputFile() })\r\n      this.map.addMapping({\r\n        source: this.opts.from\r\n          ? this.toUrl(this.path(this.opts.from))\r\n          : '<no source>',\r\n        generated: { line: 1, column: 0 },\r\n        original: { line: 1, column: 0 }\r\n      })\r\n    }\r\n\r\n    if (this.isSourcesContent()) this.setSourcesContent()\r\n    if (this.root && this.previous().length > 0) this.applyPrevMaps()\r\n    if (this.isAnnotation()) this.addAnnotation()\r\n\r\n    if (this.isInline()) {\r\n      return [this.css]\r\n    } else {\r\n      return [this.css, this.map]\r\n    }\r\n  }\r\n\r\n  path(file) {\r\n    if (file.indexOf('<') === 0) return file\r\n    if (/^\\w+:\\/\\//.test(file)) return file\r\n    if (this.mapOpts.absolute) return file\r\n\r\n    let from = this.opts.to ? dirname(this.opts.to) : '.'\r\n\r\n    if (typeof this.mapOpts.annotation === 'string') {\r\n      from = dirname(resolve(from, this.mapOpts.annotation))\r\n    }\r\n\r\n    file = relative(from, file)\r\n    return file\r\n  }\r\n\r\n  toUrl(path) {\r\n    if (sep === '\\\\') {\r\n      path = path.replace(/\\\\/g, '/')\r\n    }\r\n    return encodeURI(path).replace(/[#?]/g, encodeURIComponent)\r\n  }\r\n\r\n  sourcePath(node) {\r\n    if (this.mapOpts.from) {\r\n      return this.toUrl(this.mapOpts.from)\r\n    } else if (this.mapOpts.absolute) {\r\n      if (pathToFileURL) {\r\n        return pathToFileURL(node.source.input.from).toString()\r\n      } else {\r\n        throw new Error(\r\n          '`map.absolute` option is not available in this PostCSS build'\r\n        )\r\n      }\r\n    } else {\r\n      return this.toUrl(this.path(node.source.input.from))\r\n    }\r\n  }\r\n\r\n  generateString() {\r\n    this.css = ''\r\n    this.map = new SourceMapGenerator({ file: this.outputFile() })\r\n\r\n    let line = 1\r\n    let column = 1\r\n\r\n    let noSource = '<no source>'\r\n    let mapping = {\r\n      source: '',\r\n      generated: { line: 0, column: 0 },\r\n      original: { line: 0, column: 0 }\r\n    }\r\n\r\n    let lines, last\r\n    this.stringify(this.root, (str, node, type) => {\r\n      this.css += str\r\n\r\n      if (node && type !== 'end') {\r\n        mapping.generated.line = line\r\n        mapping.generated.column = column - 1\r\n        if (node.source && node.source.start) {\r\n          mapping.source = this.sourcePath(node)\r\n          mapping.original.line = node.source.start.line\r\n          mapping.original.column = node.source.start.column - 1\r\n          this.map.addMapping(mapping)\r\n        } else {\r\n          mapping.source = noSource\r\n          mapping.original.line = 1\r\n          mapping.original.column = 0\r\n          this.map.addMapping(mapping)\r\n        }\r\n      }\r\n\r\n      lines = str.match(/\\n/g)\r\n      if (lines) {\r\n        line += lines.length\r\n        last = str.lastIndexOf('\\n')\r\n        column = str.length - last\r\n      } else {\r\n        column += str.length\r\n      }\r\n\r\n      if (node && type !== 'start') {\r\n        let p = node.parent || { raws: {} }\r\n        if (node.type !== 'decl' || node !== p.last || p.raws.semicolon) {\r\n          if (node.source && node.source.end) {\r\n            mapping.source = this.sourcePath(node)\r\n            mapping.original.line = node.source.end.line\r\n            mapping.original.column = node.source.end.column - 1\r\n            mapping.generated.line = line\r\n            mapping.generated.column = column - 2\r\n            this.map.addMapping(mapping)\r\n          } else {\r\n            mapping.source = noSource\r\n            mapping.original.line = 1\r\n            mapping.original.column = 0\r\n            mapping.generated.line = line\r\n            mapping.generated.column = column - 1\r\n            this.map.addMapping(mapping)\r\n          }\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  generate() {\r\n    this.clearAnnotation()\r\n    if (pathAvailable && sourceMapAvailable && this.isMap()) {\r\n      return this.generateMap()\r\n    } else {\r\n      let result = ''\r\n      this.stringify(this.root, i => {\r\n        result += i\r\n      })\r\n      return [result]\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = MapGenerator\r\n"]},"metadata":{},"sourceType":"script"}