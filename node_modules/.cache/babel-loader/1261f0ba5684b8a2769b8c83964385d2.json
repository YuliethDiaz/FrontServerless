{"ast":null,"code":"import * as e from \"fs\";\nimport t from \"glob\";\nimport s from \"path\";\nimport * as r from \"postcss\";\nimport i from \"postcss-selector-parser\";\nimport { promisify as o } from \"util\";\n\nfunction n(e, t) {\n  t && t.forEach(e.add, e);\n}\n\nclass a {\n  constructor(e) {\n    this.undetermined = new Set(), this.attrNames = new Set(), this.attrValues = new Set(), this.classes = new Set(), this.ids = new Set(), this.tags = new Set(), this.merge(e);\n  }\n\n  merge(e) {\n    return Array.isArray(e) ? n(this.undetermined, e) : e instanceof a ? (n(this.undetermined, e.undetermined), n(this.attrNames, e.attrNames), n(this.attrValues, e.attrValues), n(this.classes, e.classes), n(this.ids, e.ids), n(this.tags, e.tags)) : (n(this.undetermined, e.undetermined), e.attributes && (n(this.attrNames, e.attributes.names), n(this.attrValues, e.attributes.values)), n(this.classes, e.classes), n(this.ids, e.ids), n(this.tags, e.tags)), this;\n  }\n\n  hasAttrName(e) {\n    return this.attrNames.has(e) || this.undetermined.has(e);\n  }\n\n  someAttrValue(e) {\n    for (const t of this.attrValues) if (e(t)) return !0;\n\n    for (const t of this.undetermined) if (e(t)) return !0;\n\n    return !1;\n  }\n\n  hasAttrPrefix(e) {\n    return this.someAttrValue(t => t.startsWith(e));\n  }\n\n  hasAttrSuffix(e) {\n    return this.someAttrValue(t => t.endsWith(e));\n  }\n\n  hasAttrSubstr(e) {\n    return e.trim().split(\" \").every(e => this.someAttrValue(t => t.includes(e)));\n  }\n\n  hasAttrValue(e) {\n    return this.attrValues.has(e) || this.undetermined.has(e);\n  }\n\n  hasClass(e) {\n    return this.classes.has(e) || this.undetermined.has(e);\n  }\n\n  hasId(e) {\n    return this.ids.has(e) || this.undetermined.has(e);\n  }\n\n  hasTag(e) {\n    return this.tags.has(e) || this.undetermined.has(e);\n  }\n\n}\n\nconst c = [\"*\", \":root\", \":after\", \":before\"],\n      l = {\n  css: [],\n  content: [],\n  defaultExtractor: e => e.match(/[A-Za-z0-9_-]+/g) || [],\n  extractors: [],\n  fontFace: !1,\n  keyframes: !1,\n  rejected: !1,\n  rejectedCss: !1,\n  stdin: !1,\n  stdout: !1,\n  variables: !1,\n  safelist: {\n    standard: [],\n    deep: [],\n    greedy: [],\n    variables: [],\n    keyframes: []\n  },\n  blocklist: [],\n  skippedContentGlobs: [],\n  dynamicAttributes: []\n};\n\nfunction u(e, t) {\n  const s = [];\n  return e.replace(t, function () {\n    const t = arguments,\n          r = Array.prototype.slice.call(t, 0, -2);\n    return r.input = t[t.length - 1], r.index = t[t.length - 2], s.push(r), e;\n  }), s;\n}\n\nclass h {\n  constructor(e) {\n    this.nodes = [], this.isUsed = !1, this.value = e;\n  }\n\n}\n\nclass d {\n  constructor() {\n    this.nodes = new Map(), this.usedVariables = new Set(), this.safelist = [];\n  }\n\n  addVariable(e) {\n    const {\n      prop: t\n    } = e;\n\n    if (this.nodes.has(t)) {\n      const s = new h(e),\n            r = this.nodes.get(t) || [];\n      this.nodes.set(t, [...r, s]);\n    } else {\n      const s = new h(e);\n      this.nodes.set(t, [s]);\n    }\n  }\n\n  addVariableUsage(e, t) {\n    const {\n      prop: s\n    } = e,\n          r = this.nodes.get(s);\n\n    for (const e of t) {\n      const t = e[1];\n\n      if (this.nodes.has(t)) {\n        const e = this.nodes.get(t);\n        null == r || r.forEach(t => {\n          null == e || e.forEach(e => t.nodes.push(e));\n        });\n      }\n    }\n  }\n\n  addVariableUsageInProperties(e) {\n    for (const t of e) {\n      const e = t[1];\n      this.usedVariables.add(e);\n    }\n  }\n\n  setAsUsed(e) {\n    const t = this.nodes.get(e);\n\n    if (t) {\n      const e = [...t];\n\n      for (; 0 !== e.length;) {\n        const t = e.pop();\n        t && !t.isUsed && (t.isUsed = !0, e.push(...t.nodes));\n      }\n    }\n  }\n\n  removeUnused() {\n    for (const e of this.usedVariables) {\n      const t = this.nodes.get(e);\n      if (t) for (const e of t) {\n        u(e.value.value, /var\\((.+?)[,)]/g).forEach(e => {\n          this.usedVariables.has(e[1]) || this.usedVariables.add(e[1]);\n        });\n      }\n    }\n\n    for (const e of this.usedVariables) this.setAsUsed(e);\n\n    for (const [e, t] of this.nodes) for (const s of t) s.isUsed || this.isVariablesSafelisted(e) || s.value.remove();\n  }\n\n  isVariablesSafelisted(e) {\n    return this.safelist.some(t => \"string\" == typeof t ? t === e : t.test(e));\n  }\n\n}\n\nconst f = {\n  access: o(e.access),\n  readFile: o(e.readFile)\n};\n\nfunction p(e = []) {\n  return Array.isArray(e) ? { ...l.safelist,\n    standard: e\n  } : { ...l.safelist,\n    ...e\n  };\n}\n\nasync function m(e = \"purgecss.config.js\") {\n  let t;\n\n  try {\n    const r = s.resolve(process.cwd(), e);\n    t = await import(r);\n  } catch (e) {\n    throw new Error(`Error loading the config file ${e.message}`);\n  }\n\n  return { ...l,\n    ...t,\n    safelist: p(t.safelist)\n  };\n}\n\nasync function g(e, t) {\n  return new a(await t(e));\n}\n\nfunction v(e, t) {\n  switch (t) {\n    case \"next\":\n      return e.text.includes(\"purgecss ignore\");\n\n    case \"start\":\n      return e.text.includes(\"purgecss start ignore\");\n\n    case \"end\":\n      return e.text.includes(\"purgecss end ignore\");\n  }\n}\n\nfunction y(...e) {\n  const t = new a([]);\n  return e.forEach(t.merge, t), t;\n}\n\nfunction S(e) {\n  return e.replace(/(^[\"'])|([\"']$)/g, \"\");\n}\n\nfunction b(e, t) {\n  if (!t.hasAttrName(e.attribute)) return !1;\n  if (void 0 === e.value) return !0;\n\n  switch (e.operator) {\n    case \"$=\":\n      return t.hasAttrSuffix(e.value);\n\n    case \"~=\":\n    case \"*=\":\n      return t.hasAttrSubstr(e.value);\n\n    case \"=\":\n      return t.hasAttrValue(e.value);\n\n    case \"|=\":\n    case \"^=\":\n      return t.hasAttrPrefix(e.value);\n\n    default:\n      return !0;\n  }\n}\n\nfunction w(e, t) {\n  return t.hasId(e.value);\n}\n\nfunction A(e, t) {\n  return t.hasTag(e.value);\n}\n\nfunction F(e) {\n  return \"atrule\" === (null == e ? void 0 : e.type);\n}\n\nfunction V(e) {\n  return \"rule\" === (null == e ? void 0 : e.type);\n}\n\nclass k {\n  constructor() {\n    this.ignore = !1, this.atRules = {\n      fontFace: [],\n      keyframes: []\n    }, this.usedAnimations = new Set(), this.usedFontFaces = new Set(), this.selectorsRemoved = new Set(), this.removedNodes = [], this.variablesStructure = new d(), this.options = l;\n  }\n\n  collectDeclarationsData(e) {\n    const {\n      prop: t,\n      value: s\n    } = e;\n\n    if (this.options.variables) {\n      const r = u(s, /var\\((.+?)[,)]/g);\n      t.startsWith(\"--\") ? (this.variablesStructure.addVariable(e), r.length > 0 && this.variablesStructure.addVariableUsage(e, r)) : r.length > 0 && this.variablesStructure.addVariableUsageInProperties(r);\n    }\n\n    if (!this.options.keyframes || \"animation\" !== t && \"animation-name\" !== t) {\n      if (this.options.fontFace) {\n        if (\"font-family\" === t) for (const e of s.split(\",\")) {\n          const t = S(e.trim());\n          this.usedFontFaces.add(t);\n        }\n      } else ;\n    } else for (const e of s.split(/[\\s,]+/)) this.usedAnimations.add(e);\n  }\n\n  getFileExtractor(e, t) {\n    const s = t.find(t => t.extensions.find(t => e.endsWith(t)));\n    return void 0 === s ? this.options.defaultExtractor : s.extractor;\n  }\n\n  async extractSelectorsFromFiles(s, r) {\n    const i = new a([]);\n\n    for (const o of s) {\n      let s = [];\n\n      try {\n        await f.access(o, e.constants.F_OK), s.push(o);\n      } catch (e) {\n        s = t.sync(o, {\n          nodir: !0,\n          ignore: this.options.skippedContentGlobs\n        });\n      }\n\n      for (const e of s) {\n        const t = await f.readFile(e, \"utf-8\"),\n              s = this.getFileExtractor(e, r),\n              o = await g(t, s);\n        i.merge(o);\n      }\n    }\n\n    return i;\n  }\n\n  async extractSelectorsFromString(e, t) {\n    const s = new a([]);\n\n    for (const {\n      raw: r,\n      extension: i\n    } of e) {\n      const e = this.getFileExtractor(`.${i}`, t),\n            o = await g(r, e);\n      s.merge(o);\n    }\n\n    return s;\n  }\n\n  evaluateAtRule(e) {\n    if (this.options.keyframes && e.name.endsWith(\"keyframes\")) this.atRules.keyframes.push(e);else if (this.options.fontFace && \"font-face\" === e.name && e.nodes) for (const t of e.nodes) \"decl\" === t.type && \"font-family\" === t.prop && this.atRules.fontFace.push({\n      name: S(t.value),\n      node: e\n    });\n  }\n\n  evaluateRule(e, t) {\n    if (this.ignore) return;\n    const s = e.prev();\n    if (function (e) {\n      return \"comment\" === (null == e ? void 0 : e.type);\n    }(s) && v(s, \"next\")) return void s.remove();\n    if (e.parent && F(e.parent) && e.parent.name.endsWith(\"keyframes\")) return;\n    if (!V(e)) return;\n    if (function (e) {\n      let t = !1;\n      return e.walkComments(e => {\n        e && \"comment\" === e.type && e.text.includes(\"purgecss ignore current\") && (t = !0, e.remove());\n      }), t;\n    }(e)) return;\n    let r = !0;\n    const o = [];\n    if (e.selector = i(e => {\n      e.walk(e => {\n        \"selector\" === e.type && (r = this.shouldKeepSelector(e, t), r || (this.options.rejected && this.selectorsRemoved.add(e.toString()), this.options.rejectedCss && o.push(e.toString()), e.remove()));\n      });\n    }).processSync(e.selector), r && void 0 !== e.nodes) for (const t of e.nodes) \"decl\" === t.type && this.collectDeclarationsData(t);\n    const n = e.parent;\n\n    if (e.selector || e.remove(), function (e) {\n      return !!(V(e) && !e.selector || (null == e ? void 0 : e.nodes) && !e.nodes.length || F(e) && (!e.nodes && !e.params || !e.params && e.nodes && !e.nodes.length));\n    }(n) && (null == n || n.remove()), this.options.rejectedCss && o.length > 0) {\n      const t = e.clone(),\n            s = null == n ? void 0 : n.clone().removeAll().append(t);\n      t.selectors = o;\n      const r = s || t;\n      this.removedNodes.push(r);\n    }\n  }\n\n  async getPurgedCSS(e, s) {\n    const i = [],\n          o = [];\n\n    for (const s of e) \"string\" == typeof s ? o.push(...t.sync(s, {\n      nodir: !0,\n      ignore: this.options.skippedContentGlobs\n    })) : o.push(s);\n\n    for (const e of o) {\n      const t = \"string\" == typeof e ? this.options.stdin ? e : await f.readFile(e, \"utf-8\") : e.raw,\n            o = r.parse(t);\n      this.walkThroughCSS(o, s), this.options.fontFace && this.removeUnusedFontFaces(), this.options.keyframes && this.removeUnusedKeyframes(), this.options.variables && this.removeUnusedCSSVariables();\n      const n = {\n        css: o.toString(),\n        file: \"string\" == typeof e ? e : e.name\n      };\n      this.options.rejected && (n.rejected = Array.from(this.selectorsRemoved), this.selectorsRemoved.clear()), this.options.rejectedCss && (n.rejectedCss = r.root({\n        nodes: this.removedNodes\n      }).toString()), i.push(n);\n    }\n\n    return i;\n  }\n\n  isKeyframesSafelisted(e) {\n    return this.options.safelist.keyframes.some(t => \"string\" == typeof t ? t === e : t.test(e));\n  }\n\n  isSelectorBlocklisted(e) {\n    return this.options.blocklist.some(t => \"string\" == typeof t ? t === e : t.test(e));\n  }\n\n  isSelectorSafelisted(e) {\n    const t = this.options.safelist.standard.some(t => \"string\" == typeof t ? t === e : t.test(e)),\n          s = /^::.*/.test(e);\n    return c.includes(e) || s || t;\n  }\n\n  isSelectorSafelistedDeep(e) {\n    return this.options.safelist.deep.some(t => t.test(e));\n  }\n\n  isSelectorSafelistedGreedy(e) {\n    return this.options.safelist.greedy.some(t => t.test(e));\n  }\n\n  async purge(e) {\n    this.options = \"object\" != typeof e ? await m(e) : { ...l,\n      ...e,\n      safelist: p(e.safelist)\n    };\n    const {\n      content: t,\n      css: s,\n      extractors: r,\n      safelist: i\n    } = this.options;\n    this.options.variables && (this.variablesStructure.safelist = i.variables || []);\n    const o = t.filter(e => \"string\" == typeof e),\n          n = t.filter(e => \"object\" == typeof e),\n          a = await this.extractSelectorsFromFiles(o, r),\n          c = await this.extractSelectorsFromString(n, r);\n    return this.getPurgedCSS(s, y(a, c));\n  }\n\n  removeUnusedCSSVariables() {\n    this.variablesStructure.removeUnused();\n  }\n\n  removeUnusedFontFaces() {\n    for (const {\n      name: e,\n      node: t\n    } of this.atRules.fontFace) this.usedFontFaces.has(e) || t.remove();\n  }\n\n  removeUnusedKeyframes() {\n    for (const e of this.atRules.keyframes) this.usedAnimations.has(e.params) || this.isKeyframesSafelisted(e.params) || e.remove();\n  }\n\n  getSelectorValue(e) {\n    return \"attribute\" === e.type && e.attribute || e.value;\n  }\n\n  shouldKeepSelector(e, t) {\n    if (function (e) {\n      return e.parent && \"pseudo\" === e.parent.type && e.parent.value.startsWith(\":\") || !1;\n    }(e)) return !0;\n\n    if (this.options.safelist.greedy.length > 0) {\n      if (e.nodes.map(this.getSelectorValue).some(e => e && this.isSelectorSafelistedGreedy(e))) return !0;\n    }\n\n    let s = !1;\n\n    for (const i of e.nodes) {\n      const e = this.getSelectorValue(i);\n      if (e && this.isSelectorSafelistedDeep(e)) return !0;\n      if (e && (c.includes(e) || this.isSelectorSafelisted(e))) s = !0;else {\n        if (e && this.isSelectorBlocklisted(e)) return !1;\n\n        switch (i.type) {\n          case \"attribute\":\n            s = !![...this.options.dynamicAttributes, \"value\", \"checked\", \"selected\", \"open\"].includes(i.attribute) || b(i, t);\n            break;\n\n          case \"class\":\n            r = i, s = t.hasClass(r.value);\n            break;\n\n          case \"id\":\n            s = w(i, t);\n            break;\n\n          case \"tag\":\n            s = A(i, t);\n            break;\n\n          default:\n            continue;\n        }\n\n        if (!s) return !1;\n      }\n    }\n\n    var r;\n    return s;\n  }\n\n  walkThroughCSS(e, t) {\n    e.walk(e => \"rule\" === e.type ? this.evaluateRule(e, t) : \"atrule\" === e.type ? this.evaluateAtRule(e) : void (\"comment\" === e.type && (v(e, \"start\") ? (this.ignore = !0, e.remove()) : v(e, \"end\") && (this.ignore = !1, e.remove()))));\n  }\n\n}\n\nexport { k as PurgeCSS, k as default, l as defaultOptions, y as mergeExtractorSelectors, m as setOptions, p as standardizeSafelist };","map":{"version":3,"sources":["C:/Users/Valen/OneDrive/Documentos/Proyecto AWS/FrontServerless/node_modules/purgecss/lib/purgecss.esm.js"],"names":["e","t","s","r","i","promisify","o","n","forEach","add","a","constructor","undetermined","Set","attrNames","attrValues","classes","ids","tags","merge","Array","isArray","attributes","names","values","hasAttrName","has","someAttrValue","hasAttrPrefix","startsWith","hasAttrSuffix","endsWith","hasAttrSubstr","trim","split","every","includes","hasAttrValue","hasClass","hasId","hasTag","c","l","css","content","defaultExtractor","match","extractors","fontFace","keyframes","rejected","rejectedCss","stdin","stdout","variables","safelist","standard","deep","greedy","blocklist","skippedContentGlobs","dynamicAttributes","u","replace","arguments","prototype","slice","call","input","length","index","push","h","nodes","isUsed","value","d","Map","usedVariables","addVariable","prop","get","set","addVariableUsage","addVariableUsageInProperties","setAsUsed","pop","removeUnused","isVariablesSafelisted","remove","some","test","f","access","readFile","p","m","resolve","process","cwd","Error","message","g","v","text","y","S","b","attribute","operator","w","A","F","type","V","k","ignore","atRules","usedAnimations","usedFontFaces","selectorsRemoved","removedNodes","variablesStructure","options","collectDeclarationsData","getFileExtractor","find","extensions","extractor","extractSelectorsFromFiles","constants","F_OK","sync","nodir","extractSelectorsFromString","raw","extension","evaluateAtRule","name","node","evaluateRule","prev","parent","walkComments","selector","walk","shouldKeepSelector","toString","processSync","params","clone","removeAll","append","selectors","getPurgedCSS","parse","walkThroughCSS","removeUnusedFontFaces","removeUnusedKeyframes","removeUnusedCSSVariables","file","from","clear","root","isKeyframesSafelisted","isSelectorBlocklisted","isSelectorSafelisted","isSelectorSafelistedDeep","isSelectorSafelistedGreedy","purge","filter","getSelectorValue","map","PurgeCSS","default","defaultOptions","mergeExtractorSelectors","setOptions","standardizeSafelist"],"mappings":"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","sourcesContent":["import*as e from\"fs\";import t from\"glob\";import s from\"path\";import*as r from\"postcss\";import i from\"postcss-selector-parser\";import{promisify as o}from\"util\";function n(e,t){t&&t.forEach(e.add,e)}class a{constructor(e){this.undetermined=new Set,this.attrNames=new Set,this.attrValues=new Set,this.classes=new Set,this.ids=new Set,this.tags=new Set,this.merge(e)}merge(e){return Array.isArray(e)?n(this.undetermined,e):e instanceof a?(n(this.undetermined,e.undetermined),n(this.attrNames,e.attrNames),n(this.attrValues,e.attrValues),n(this.classes,e.classes),n(this.ids,e.ids),n(this.tags,e.tags)):(n(this.undetermined,e.undetermined),e.attributes&&(n(this.attrNames,e.attributes.names),n(this.attrValues,e.attributes.values)),n(this.classes,e.classes),n(this.ids,e.ids),n(this.tags,e.tags)),this}hasAttrName(e){return this.attrNames.has(e)||this.undetermined.has(e)}someAttrValue(e){for(const t of this.attrValues)if(e(t))return!0;for(const t of this.undetermined)if(e(t))return!0;return!1}hasAttrPrefix(e){return this.someAttrValue((t=>t.startsWith(e)))}hasAttrSuffix(e){return this.someAttrValue((t=>t.endsWith(e)))}hasAttrSubstr(e){return e.trim().split(\" \").every((e=>this.someAttrValue((t=>t.includes(e)))))}hasAttrValue(e){return this.attrValues.has(e)||this.undetermined.has(e)}hasClass(e){return this.classes.has(e)||this.undetermined.has(e)}hasId(e){return this.ids.has(e)||this.undetermined.has(e)}hasTag(e){return this.tags.has(e)||this.undetermined.has(e)}}const c=[\"*\",\":root\",\":after\",\":before\"],l={css:[],content:[],defaultExtractor:e=>e.match(/[A-Za-z0-9_-]+/g)||[],extractors:[],fontFace:!1,keyframes:!1,rejected:!1,rejectedCss:!1,stdin:!1,stdout:!1,variables:!1,safelist:{standard:[],deep:[],greedy:[],variables:[],keyframes:[]},blocklist:[],skippedContentGlobs:[],dynamicAttributes:[]};function u(e,t){const s=[];return e.replace(t,(function(){const t=arguments,r=Array.prototype.slice.call(t,0,-2);return r.input=t[t.length-1],r.index=t[t.length-2],s.push(r),e})),s}class h{constructor(e){this.nodes=[],this.isUsed=!1,this.value=e}}class d{constructor(){this.nodes=new Map,this.usedVariables=new Set,this.safelist=[]}addVariable(e){const{prop:t}=e;if(this.nodes.has(t)){const s=new h(e),r=this.nodes.get(t)||[];this.nodes.set(t,[...r,s])}else{const s=new h(e);this.nodes.set(t,[s])}}addVariableUsage(e,t){const{prop:s}=e,r=this.nodes.get(s);for(const e of t){const t=e[1];if(this.nodes.has(t)){const e=this.nodes.get(t);null==r||r.forEach((t=>{null==e||e.forEach((e=>t.nodes.push(e)))}))}}}addVariableUsageInProperties(e){for(const t of e){const e=t[1];this.usedVariables.add(e)}}setAsUsed(e){const t=this.nodes.get(e);if(t){const e=[...t];for(;0!==e.length;){const t=e.pop();t&&!t.isUsed&&(t.isUsed=!0,e.push(...t.nodes))}}}removeUnused(){for(const e of this.usedVariables){const t=this.nodes.get(e);if(t)for(const e of t){u(e.value.value,/var\\((.+?)[,)]/g).forEach((e=>{this.usedVariables.has(e[1])||this.usedVariables.add(e[1])}))}}for(const e of this.usedVariables)this.setAsUsed(e);for(const[e,t]of this.nodes)for(const s of t)s.isUsed||this.isVariablesSafelisted(e)||s.value.remove()}isVariablesSafelisted(e){return this.safelist.some((t=>\"string\"==typeof t?t===e:t.test(e)))}}const f={access:o(e.access),readFile:o(e.readFile)};function p(e=[]){return Array.isArray(e)?{...l.safelist,standard:e}:{...l.safelist,...e}}async function m(e=\"purgecss.config.js\"){let t;try{const r=s.resolve(process.cwd(),e);t=await import(r)}catch(e){throw new Error(`Error loading the config file ${e.message}`)}return{...l,...t,safelist:p(t.safelist)}}async function g(e,t){return new a(await t(e))}function v(e,t){switch(t){case\"next\":return e.text.includes(\"purgecss ignore\");case\"start\":return e.text.includes(\"purgecss start ignore\");case\"end\":return e.text.includes(\"purgecss end ignore\")}}function y(...e){const t=new a([]);return e.forEach(t.merge,t),t}function S(e){return e.replace(/(^[\"'])|([\"']$)/g,\"\")}function b(e,t){if(!t.hasAttrName(e.attribute))return!1;if(void 0===e.value)return!0;switch(e.operator){case\"$=\":return t.hasAttrSuffix(e.value);case\"~=\":case\"*=\":return t.hasAttrSubstr(e.value);case\"=\":return t.hasAttrValue(e.value);case\"|=\":case\"^=\":return t.hasAttrPrefix(e.value);default:return!0}}function w(e,t){return t.hasId(e.value)}function A(e,t){return t.hasTag(e.value)}function F(e){return\"atrule\"===(null==e?void 0:e.type)}function V(e){return\"rule\"===(null==e?void 0:e.type)}class k{constructor(){this.ignore=!1,this.atRules={fontFace:[],keyframes:[]},this.usedAnimations=new Set,this.usedFontFaces=new Set,this.selectorsRemoved=new Set,this.removedNodes=[],this.variablesStructure=new d,this.options=l}collectDeclarationsData(e){const{prop:t,value:s}=e;if(this.options.variables){const r=u(s,/var\\((.+?)[,)]/g);t.startsWith(\"--\")?(this.variablesStructure.addVariable(e),r.length>0&&this.variablesStructure.addVariableUsage(e,r)):r.length>0&&this.variablesStructure.addVariableUsageInProperties(r)}if(!this.options.keyframes||\"animation\"!==t&&\"animation-name\"!==t)if(this.options.fontFace){if(\"font-family\"===t)for(const e of s.split(\",\")){const t=S(e.trim());this.usedFontFaces.add(t)}}else;else for(const e of s.split(/[\\s,]+/))this.usedAnimations.add(e)}getFileExtractor(e,t){const s=t.find((t=>t.extensions.find((t=>e.endsWith(t)))));return void 0===s?this.options.defaultExtractor:s.extractor}async extractSelectorsFromFiles(s,r){const i=new a([]);for(const o of s){let s=[];try{await f.access(o,e.constants.F_OK),s.push(o)}catch(e){s=t.sync(o,{nodir:!0,ignore:this.options.skippedContentGlobs})}for(const e of s){const t=await f.readFile(e,\"utf-8\"),s=this.getFileExtractor(e,r),o=await g(t,s);i.merge(o)}}return i}async extractSelectorsFromString(e,t){const s=new a([]);for(const{raw:r,extension:i}of e){const e=this.getFileExtractor(`.${i}`,t),o=await g(r,e);s.merge(o)}return s}evaluateAtRule(e){if(this.options.keyframes&&e.name.endsWith(\"keyframes\"))this.atRules.keyframes.push(e);else if(this.options.fontFace&&\"font-face\"===e.name&&e.nodes)for(const t of e.nodes)\"decl\"===t.type&&\"font-family\"===t.prop&&this.atRules.fontFace.push({name:S(t.value),node:e})}evaluateRule(e,t){if(this.ignore)return;const s=e.prev();if(function(e){return\"comment\"===(null==e?void 0:e.type)}(s)&&v(s,\"next\"))return void s.remove();if(e.parent&&F(e.parent)&&e.parent.name.endsWith(\"keyframes\"))return;if(!V(e))return;if(function(e){let t=!1;return e.walkComments((e=>{e&&\"comment\"===e.type&&e.text.includes(\"purgecss ignore current\")&&(t=!0,e.remove())})),t}(e))return;let r=!0;const o=[];if(e.selector=i((e=>{e.walk((e=>{\"selector\"===e.type&&(r=this.shouldKeepSelector(e,t),r||(this.options.rejected&&this.selectorsRemoved.add(e.toString()),this.options.rejectedCss&&o.push(e.toString()),e.remove()))}))})).processSync(e.selector),r&&void 0!==e.nodes)for(const t of e.nodes)\"decl\"===t.type&&this.collectDeclarationsData(t);const n=e.parent;if(e.selector||e.remove(),function(e){return!!(V(e)&&!e.selector||(null==e?void 0:e.nodes)&&!e.nodes.length||F(e)&&(!e.nodes&&!e.params||!e.params&&e.nodes&&!e.nodes.length))}(n)&&(null==n||n.remove()),this.options.rejectedCss&&o.length>0){const t=e.clone(),s=null==n?void 0:n.clone().removeAll().append(t);t.selectors=o;const r=s||t;this.removedNodes.push(r)}}async getPurgedCSS(e,s){const i=[],o=[];for(const s of e)\"string\"==typeof s?o.push(...t.sync(s,{nodir:!0,ignore:this.options.skippedContentGlobs})):o.push(s);for(const e of o){const t=\"string\"==typeof e?this.options.stdin?e:await f.readFile(e,\"utf-8\"):e.raw,o=r.parse(t);this.walkThroughCSS(o,s),this.options.fontFace&&this.removeUnusedFontFaces(),this.options.keyframes&&this.removeUnusedKeyframes(),this.options.variables&&this.removeUnusedCSSVariables();const n={css:o.toString(),file:\"string\"==typeof e?e:e.name};this.options.rejected&&(n.rejected=Array.from(this.selectorsRemoved),this.selectorsRemoved.clear()),this.options.rejectedCss&&(n.rejectedCss=r.root({nodes:this.removedNodes}).toString()),i.push(n)}return i}isKeyframesSafelisted(e){return this.options.safelist.keyframes.some((t=>\"string\"==typeof t?t===e:t.test(e)))}isSelectorBlocklisted(e){return this.options.blocklist.some((t=>\"string\"==typeof t?t===e:t.test(e)))}isSelectorSafelisted(e){const t=this.options.safelist.standard.some((t=>\"string\"==typeof t?t===e:t.test(e))),s=/^::.*/.test(e);return c.includes(e)||s||t}isSelectorSafelistedDeep(e){return this.options.safelist.deep.some((t=>t.test(e)))}isSelectorSafelistedGreedy(e){return this.options.safelist.greedy.some((t=>t.test(e)))}async purge(e){this.options=\"object\"!=typeof e?await m(e):{...l,...e,safelist:p(e.safelist)};const{content:t,css:s,extractors:r,safelist:i}=this.options;this.options.variables&&(this.variablesStructure.safelist=i.variables||[]);const o=t.filter((e=>\"string\"==typeof e)),n=t.filter((e=>\"object\"==typeof e)),a=await this.extractSelectorsFromFiles(o,r),c=await this.extractSelectorsFromString(n,r);return this.getPurgedCSS(s,y(a,c))}removeUnusedCSSVariables(){this.variablesStructure.removeUnused()}removeUnusedFontFaces(){for(const{name:e,node:t}of this.atRules.fontFace)this.usedFontFaces.has(e)||t.remove()}removeUnusedKeyframes(){for(const e of this.atRules.keyframes)this.usedAnimations.has(e.params)||this.isKeyframesSafelisted(e.params)||e.remove()}getSelectorValue(e){return\"attribute\"===e.type&&e.attribute||e.value}shouldKeepSelector(e,t){if(function(e){return e.parent&&\"pseudo\"===e.parent.type&&e.parent.value.startsWith(\":\")||!1}(e))return!0;if(this.options.safelist.greedy.length>0){if(e.nodes.map(this.getSelectorValue).some((e=>e&&this.isSelectorSafelistedGreedy(e))))return!0}let s=!1;for(const i of e.nodes){const e=this.getSelectorValue(i);if(e&&this.isSelectorSafelistedDeep(e))return!0;if(e&&(c.includes(e)||this.isSelectorSafelisted(e)))s=!0;else{if(e&&this.isSelectorBlocklisted(e))return!1;switch(i.type){case\"attribute\":s=!![...this.options.dynamicAttributes,\"value\",\"checked\",\"selected\",\"open\"].includes(i.attribute)||b(i,t);break;case\"class\":r=i,s=t.hasClass(r.value);break;case\"id\":s=w(i,t);break;case\"tag\":s=A(i,t);break;default:continue}if(!s)return!1}}var r;return s}walkThroughCSS(e,t){e.walk((e=>\"rule\"===e.type?this.evaluateRule(e,t):\"atrule\"===e.type?this.evaluateAtRule(e):void(\"comment\"===e.type&&(v(e,\"start\")?(this.ignore=!0,e.remove()):v(e,\"end\")&&(this.ignore=!1,e.remove())))))}}export{k as PurgeCSS,k as default,l as defaultOptions,y as mergeExtractorSelectors,m as setOptions,p as standardizeSafelist};\r\n"]},"metadata":{},"sourceType":"module"}